USE DB7AM


--Emp Table

CREATE TABLE EMP(
EMPNO SMALLINT,
ENAME VARCHAR(10),
JOB VARCHAR(9),
MGR	NUMERIC(4),
HIREDATE DATE,
SAL MONEY,
COMM MONEY,
DEPTNO TINYINT
)


INSERT INTO EMP VALUES
(7369, 'SMITH', 'CLERK', 7902, '1980-12-17', 800, NULL, 20)

INSERT INTO EMP VALUES
(7499, 'ALLEN', 'SALESMAN', 7698, '20-FEB-1981', 1600, 300, 30)

INSERT INTO EMP VALUES
(7521, 'WARD', 'SALESMAN', 7698, '22-FEB-1981', 1250, 500, 30)

INSERT INTO EMP VALUES
(7566, 'JONES', 'MANAGER', 7839, '2-APR-1981', 2975, NULL, 20)

INSERT INTO EMP VALUES
(7654, 'MARTIN', 'SALESMAN', 7698, '28-SEP-1981', 1250, 1400, 30)

INSERT INTO EMP VALUES
(7698, 'BLAKE', 'MANAGER', 7839, '1-MAY-1981', 2850, NULL, 30)

INSERT INTO EMP VALUES
(7782, 'CLARK', 'MANAGER', 7839, '9-JUN-1981', 2450, NULL, 10)

INSERT INTO EMP VALUES
(7788, 'SCOTT', 'ANALYST', 7566, '09-DEC-1982', 3000, NULL, 20)

INSERT INTO EMP VALUES
(7839, 'KING', 'PRESIDENT', NULL, '17-NOV-1981', 5000, NULL, 10)

INSERT INTO EMP VALUES
(7844, 'TURNER', 'SALESMAN', 7698, '8-SEP-1981', 1500, 0, 30)

INSERT INTO EMP VALUES
(7876, 'ADAMS', 'CLERK', 7788, '12-JAN-1983', 1100, NULL, 20)

INSERT INTO EMP VALUES
(7900, 'JAMES', 'CLERK', 7698, '3-DEC-1981', 950, NULL, 30)

INSERT INTO EMP VALUES
(7902, 'FORD', 'ANALYST', 7566, '3-DEC-1981', 3000, NULL, 20)

INSERT INTO EMP VALUES
(7934, 'MILLER', 'CLERK', 7782, '23-JAN-1982', 1300, NULL, 10)

select * from emp

--create table dept

CREATE TABLE DEPT
(
DEPTNO INT primary key,
DNAME VARCHAR(14),
LOC VARCHAR(13) 
)

INSERT INTO DEPT VALUES (10, 'ACCOUNTS', 'NEW YORK')
INSERT INTO DEPT VALUES (20, 'RESEARCH', 'DALLAS')
INSERT INTO DEPT VALUES (30, 'SALES', 'CHICAGO')
INSERT INTO DEPT VALUES (40, 'OPERATIONS', 'BOSTON')

select * from DEPT

--create bonus table
CREATE TABLE BONUS
(ENAME VARCHAR(10),
JOB VARCHAR(9),
SAL NUMERIC,
COMM NUMERIC)

--create table salgrade
CREATE TABLE SALGRADE
(GRADE NUMERIC,
LOSAL MONEY,
HISAL MONEY)

INSERT INTO SALGRADE VALUES (1, 700, 1000)
INSERT INTO SALGRADE VALUES (2, 1001, 2000)
INSERT INTO SALGRADE VALUES (3, 2001, 3000)
INSERT INTO SALGRADE VALUES (4, 3001, 4000)
INSERT INTO SALGRADE VALUES (5, 4001, 9999)

Select * from SALGRADE


-- display   ENAME   ANNUAL SAL  ?
SELECT  ENAME , SAL*12  AS  ANNSAL  FROM EMP
			--or 
SELECT  ENAME,SAL*12  AS  [ANNUAL SAL]  FROM EMP


-- DISPLAY  ENAME  SAL    HRA    DA   TAX   TOTSAL  ?
	--HRA = house rent allowance =  20% on sal
	--DA   = dearness allowance = 30% on sal
	--TAX = 10% on sal
	--TOTSAL  = SAL + HRA + DA - TAX 
SELECT  ENAME , SAL ,
SAL*0.2  as HRA ,
SAL*0.3 as DA,
SAL*0.1 as TAX,
SAL + (SAL*0.2) + (SAL*0.3) - (SAL*0.1)  as TOTALSAL FROM EMP


									-- CASE STATEMENTS--
-- DISPLAY  ENAME   JOB  ?
	--  IF JOB = CLERK DISPLAY WORKER
	-- MANAGER = BOSS
	-- PRESIDENT = BIG BOSS
	-- ELSE = EMPLOYEE
	-- END AS JOB
SELECT ENAME, 
       CASE JOB 
           WHEN 'CLERK' THEN 'WORKER'
           WHEN 'MANAGER' THEN 'BOSS'
           WHEN 'PRESIDENT' THEN 'BIG BOSS'
           ELSE 'EMPLOYEE'
       END AS JOB_TITLE
FROM EMP;

-- DISPLAY ENAME DEPT_NAME ?
	-- IF DEPTNO = 10  DISPLAY ACCOUNTS
	-- 20		RESEARCH
	-- 30		SALES
	--OTHERS	UNKOWN
SELECT ENAME ,
	CASE DEPTNO
	WHEN 10 THEN 'ACCOUNTS'
	WHEN 20 THEN 'RESEARCH'
	WHEN 30 THEN 'SALES'
	ELSE 'UNKNOWN'
	END AS DEPT_NAME
FROM EMP

									-- SEARCHED CASE --
-- DISPLAY ENAME SAL , SALRANGE ?
  -- SAL>3000 DISPLAY HISAL
  -- SAL<3000 DISPLAY LOSAL
  -- SAL=3000 DISPLAY AVGSAL
SELECT ENAME , SAL ,
	CASE 
	WHEN SAL>3000 THEN 'HISAL'
	WHEN SAL<3000 THEN 'LOSAL'
	ELSE 'AVGSAL'
	END AS SALRANGE
FROM EMP



												-- ORDER BY CLAUSE 
-- ARRANGE EMPLOYEE LIST NAME WISE ASC ORDER?
SELECT * FROM EMP ORDER BY ENAME ASC

-- ARRANGE EMPLOYEE LIST SAL WISE AND HIGHEST PAID EMPOLYEE ROW SHOULD BE DISPLAYED FIRST ?
SELECT * FROM EMP ORDER BY SAL DESC

-- ARRANGE EMPLOYEE LIST DEPT WISE ASC AND WITH IN DEPTH SAL WISE DESC ?
SELECT EMPNO,ENAME,SAL,DEPTNO FROM EMP
ORDER BY DEPTNO ASC,SAL DESC

-- FIND MOST AND LEAST EXPERIENCED EMPLOYYES IN EACH DEPT ?
SELECT EMPNO,ENAME,HIREDATE,DEPTNO FROM EMP 
ORDER BY DEPTNO ASC , HIREDATE ASC

-- DISPLAY EMPLOYYES WORKING AS CLERK,MANAGER AND ARRANGE OUTPUT SAL WISE DESC?
SELECT * FROM EMP WHERE JOB IN ('CLERK','MANAGER')
ORDER BY SAL DESC



												-- DISTINCT CLAUSE--
-- SELECT DISTINCT JOB FROM EMP
SELECT DISTINCT JOB FROM EMP

--SELECT DISTINCT DEPTNO FROM EMP
SELECT DISTINCT DEPTNO FROM EMP

												--	TOP CLAUS -- 
-- THE FOLLOWING QUERY RETURNS FIRST 3 ROWS FROM TABLE
SELECT TOP 3 * FROM EMP

-- DISPLAY TOP 5 HIGHEST PAID EMPLOYYES?
SELECT TOP 5 * FROM EMP ORDER BY SAL DESC

-- DISPLAY 3 MAX SALARIES ?
SELECT DISTINCT TOP 5 * FROM EMP ORDER BY SAL DESC

-- DISPLAY TOP 3 EMPLOYEES BASED ON EXPERIENCED ?
SELECT TOP 3 * FROM EMP ORDER BY HIREDATE ASC

